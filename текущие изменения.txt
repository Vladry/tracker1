Добавил порог схожести направления, чтобы перепривязка к цели с противоположным движением происходила только при отсутствии близких целей с похожим направлением.

Обновил выбор кандидата на перепривязку: сначала ищется ближайшая цель с направлением выше порога, иначе выбирается ближайшая без учета направления.