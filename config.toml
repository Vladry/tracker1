# ============================================================================
# Application configuration file
# Format: TOML (Tom's Obvious, Minimal Language)
#
# bbox  = Bounding Box (ограничивающий прямоугольник)
# HUD   = Heads-Up Display (экранные наложения)
# IoU   = Intersection over Union (метрика перекрытия)
# ============================================================================


[detector]
# Минимальная разница яркости между кадрами,
# при которой пиксель считается движущимся.
diff_threshold = 15

# Минимальная площадь bbox, чтобы он считался валидной детекцией.
min_area = 50

# Размер морфологического ядра для очистки бинарной маски.
morph_kernel = 5

# Коэффициент масштабирования кадра перед детекцией.
downscale = 1.0


[merge]
# Максимальное количество dynamic bbox,
# объединяемых в одну merged-цель.
max_boxes_in_cluster = 3

# Минимальный IoU (Intersection over Union),
# при котором два bbox считаются соседними.
neighbor_iou_th = 0.05

# Коэффициент расстояния между центрами bbox,
# используемый как эвристика объединения.
center_dist_factor = 5.5

# Максимальная кратность площади merged-bbox
# относительно площади САМОГО КРУПНОГО bbox в кластере.
max_area_multiplier = 3.0


[tracker]
# Максимально допустимое количество пропущенных кадров
# до потери цели.
max_missed_frames = 3

# Минимальный IoU для сопоставления bbox между кадрами.
iou_th = 0.25


[static_rebind]
# Автоматическая перепривязка static bbox при потере цели.
auto_rebind = true

# Таймаут (в миллисекундах) ожидания новой цели
# после потери родительского dynamic bbox.
rebind_timeout_ms = 800

# Приоритет расстояния (distance priority).
distance_weight = 1.0

# Приоритет размера цели (area priority).
area_weight = 1.0

# Во сколько раз новая цель должна быть крупнее предыдущей,
# чтобы считаться значимо более крупной.
larger_area_factor = 2.0

# Максимально допустимое расстояние до более крупной цели,
# выраженное как доля диагонали кадра.
# 0.2 = 1/5 диагонали.
max_large_target_dist_frac = 0.2


[overlay]
# Прозрачность HUD (Heads-Up Display).
hud_alpha = 0.25

# Прозрачность невыбранных bbox,
# когда есть активный static bbox.
unselected_alpha_when_selected = 0.3


[smoothing]
# Количество кадров для сглаживания dynamic bbox
# (moving average).
dynamic_bbox_window = 5
